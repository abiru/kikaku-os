name = "kikaku-os-api"
main = "apps/api/src/index.ts"
compatibility_date = "2026-01-01"
compatibility_flags = ["nodejs_compat"]

# Version metadata for Sentry release tracking
[version_metadata]
binding = "CF_VERSION_METADATA"

# Cloudflare Browser Rendering binding
# Note: For local development with `wrangler dev`, set remote = true
# to connect to actual Cloudflare browser instances.
# Local simulation is not available for Browser Rendering.
[browser]
binding = "BROWSER"
# Uncomment for local development testing:
# remote = true

# Cloudflare Workers AI binding
[ai]
binding = "AI"

triggers = { crons = ["0 16 * * *"] }

[observability]
enabled = true

[[d1_databases]]
binding = "DB"
database_name = "ledkikaku-os"
# IMPORTANT: Replace with actual database_id after running:
# wrangler d1 create ledkikaku-os
database_id = "DUMMY_REPLACE"

[[r2_buckets]]
binding = "R2"
bucket_name = "ledkikaku-artifacts"

# NOTE: For local development, these values are overridden by .dev.vars
# For production, DEV_MODE should be "false" and STOREFRONT_BASE_URL should be your actual domain
[vars]
DEV_MODE = "false"
# UPDATE: Replace with your actual production storefront URL after custom domain setup
STOREFRONT_BASE_URL = "https://kikaku-storefront.pages.dev"
SHIPPING_FEE_AMOUNT = "500"
FREE_SHIPPING_THRESHOLD = "5000"
COMPANY_NAME = "株式会社LED企画"
COMPANY_POSTAL_CODE = "123-4567"
COMPANY_ADDRESS = "東京都渋谷区..."
COMPANY_PHONE = "03-1234-5678"
COMPANY_EMAIL = "info@led-kikaku.com"
COMPANY_LOGO_URL = ""
# IMPORTANT: Replace with your production Stripe publishable key (pk_live_...)
# This is a public key, safe to commit, but must be your LIVE key for production
STRIPE_PUBLISHABLE_KEY = "YOUR_STRIPE_PUBLISHABLE_KEY"

# Secrets (configured via GitHub Actions or `wrangler secret put`):
# - ADMIN_API_KEY
# - STRIPE_SECRET_KEY
# - STRIPE_WEBHOOK_SECRET
# - CLAUDE_API_KEY
# - CLERK_SECRET_KEY (optional)
# - SLACK_WEBHOOK_URL (optional)
# - RESEND_API_KEY (optional)
# - SENTRY_DSN (optional)
# - AI_GATEWAY_ACCOUNT_ID (optional - for AI Gateway proxy)
# - AI_GATEWAY_ID (optional - for AI Gateway proxy)

