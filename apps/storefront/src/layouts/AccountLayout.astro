---
import Container from '../components/Container.astro';
import SiteHeader from '../components/SiteHeader.astro';
import SearchModal from '../components/SearchModal';
import CookieConsent from '../components/CookieConsent';
import { ErrorBoundary } from '../components/ErrorBoundary';
import { t } from '../i18n';
import '@fontsource/inter/400.css';
import '@fontsource/inter/500.css';
import '@fontsource/inter/600.css';
import '@fontsource/inter/700.css';
import '@fontsource/inter/900.css';
import '@fontsource/noto-sans-jp/400.css';
import '@fontsource/noto-sans-jp/500.css';
import '@fontsource/noto-sans-jp/600.css';
import '@fontsource/noto-sans-jp/700.css';
import '@fontsource/noto-sans-jp/900.css';
import '../styles/global.css';

interface Props {
  title?: string;
  activeTab?: 'dashboard' | 'orders' | 'profile';
}

const { title = 'My Account - Led Kikaku Store', activeTab = 'dashboard' } = Astro.props;

const navItems = [
  { id: 'dashboard', href: '/account', label: t('account.dashboard') },
  { id: 'orders', href: '/account/orders', label: t('account.orders') },
  { id: 'profile', href: '/account/profile', label: t('account.profile') },
];
---

<!doctype html>
<html lang="ja">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="description" content="Led Kikaku Store - My Account" />
		<meta name="theme-color" content="#ffffff" />
		<meta name="format-detection" content="telephone=no" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
		<meta name="robots" content="noindex, nofollow" />

		<!-- Open Graph -->
		<meta property="og:title" content={title} />
		<meta property="og:description" content="Led Kikaku Store - My Account" />
		<meta property="og:type" content="website" />

		<!-- Twitter Card -->
		<meta name="twitter:card" content="summary" />
		<meta name="twitter:title" content={title} />
		<meta name="twitter:description" content="Led Kikaku Store - My Account" />
	</head>
	<body class="font-sans text-primary antialiased bg-subtle">
		<a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-brand focus:text-white focus:rounded-lg focus:text-sm focus:font-medium">
			{t('accessibility.skipToContent')}
		</a>
		<div class="min-h-screen flex flex-col">
			<SiteHeader currentPath={Astro.url.pathname} showWishlist={false} showMobileMenu={false} showAuthToggle={false} />

			<main id="main-content" class="flex-1">
				{/* Account Navigation */}
				<div class="bg-white border-b border-gray-200">
					<Container>
						<div class="flex items-center gap-8 h-12 overflow-x-auto">
							{navItems.map((item) => (
								<a
									href={item.href}
									class={`text-[13px] font-medium transition-colors whitespace-nowrap border-b-2 h-full flex items-center ${
										activeTab === item.id
											? 'text-primary border-brand'
											: 'text-secondary border-transparent hover:text-primary'
									}`}
								>
									{item.label}
								</a>
							))}
						</div>
					</Container>
				</div>

				<slot />
			</main>

			<footer class="bg-subtle border-t border-gray-200 py-10 text-[11px] text-secondary">
				<Container>
					<div class="pt-4 flex flex-col md:flex-row justify-between items-center gap-4">
						<p>{t('footer.copyright').replace('{year}', String(new Date().getFullYear()))}</p>
						<div class="flex flex-wrap items-center gap-x-2 gap-y-1 text-xs">
							<a href="/legal" class="inline-block py-1.5 hover:underline">{t('footer.legalNotice')}</a>
							<span class="text-gray-300" aria-hidden="true">&middot;</span>
							<a href="/privacy" class="inline-block py-1.5 hover:underline">{t('footer.privacyPolicy')}</a>
							<span class="text-gray-300" aria-hidden="true">&middot;</span>
							<a href="/terms" class="inline-block py-1.5 hover:underline">{t('footer.termsOfUse')}</a>
							<span class="text-gray-300" aria-hidden="true">&middot;</span>
							<a href="/shipping" class="inline-block py-1.5 hover:underline">{t('footer.shippingPolicy')}</a>
							<span class="text-gray-300" aria-hidden="true">&middot;</span>
							<a href="/refund" class="inline-block py-1.5 hover:underline">{t('footer.refundPolicy')}</a>
						</div>
					</div>
				</Container>
			</footer>
		</div>

		<ErrorBoundary client:idle>
			<SearchModal />
		</ErrorBoundary>
		<ErrorBoundary client:idle>
			<CookieConsent />
		</ErrorBoundary>
	</body>
</html>
