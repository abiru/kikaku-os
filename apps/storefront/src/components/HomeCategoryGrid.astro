---
import { t } from '../i18n';
import { FOCUS_RING } from '../lib/focusRing';

interface FeaturedProduct {
  id: number;
  title: string;
  description: string | null;
  category: string | null;
  image: string | null;
}

interface Props {
  products?: FeaturedProduct[];
}

const { products = [] } = Astro.props as Props;

// Fallback placeholder if no image
const placeholderBg = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMSIgaGVpZ2h0PSIxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiNmNWY1ZjciLz48L3N2Zz4=';
---

<section class="grid grid-cols-1 gap-4 px-4 sm:grid-cols-2" data-reveal data-reveal-delay="100">
  {products.length > 0 ? (
    products.map((product) => {
      const bgImage = product.image || placeholderBg;
      const categoryName = product.category || t('nav.products');
      const description = product.description || t('home.exploreProducts');

      return (
        <article
          class="category-card card-lift relative flex h-[400px] md:h-[500px] flex-col justify-end overflow-hidden rounded-2xl"
          data-reveal-child
        >
          <img
            src={bgImage}
            alt={categoryName}
            loading="lazy"
            class="absolute inset-0 w-full h-full object-cover"
          />
          <div class="category-scrim relative z-10 px-6 pb-8 pt-20">
            <div class="space-y-2">
              <h3 class="text-3xl font-bold text-white">
                {categoryName}
              </h3>
              <p class="text-base font-medium text-neutral-200">
                {description}
              </p>
            </div>

          <div class="category-text mt-4 flex gap-2">
            <a
              href={`/products?category=${encodeURIComponent(product.category || '')}`}
              class={`rounded-lg bg-brand px-6 py-3 min-h-[44px] inline-flex items-center text-base font-semibold text-white hover:bg-brand-active active:scale-[0.98] ${FOCUS_RING} transition-colors`}
            >
              {t('home.viewProducts')}
            </a>
            <a
              href={`/products/${product.id}`}
              class={`rounded-lg bg-white/15 backdrop-blur-sm border border-white/25 px-6 py-3 min-h-[44px] inline-flex items-center text-base font-semibold text-white hover:bg-white/25 active:scale-[0.98] ${FOCUS_RING} transition-colors`}
            >
              {t('home.viewDetails')}
            </a>
          </div>
          </div>
        </article>
      );
    })
  ) : null}
</section>

<style>
  .category-scrim {
    background: linear-gradient(to top, rgba(0, 0, 0, 0.5) 0%, transparent 100%);
  }
</style>
