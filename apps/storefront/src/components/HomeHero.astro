---
interface Props {
  title: string;
  subtitle?: string;
  image?: string | null;
  imageSmall?: string | null;
  ctaPrimaryText?: string;
  ctaPrimaryUrl?: string;
  ctaSecondaryText?: string;
  ctaSecondaryUrl?: string;
}

const {
  title,
  subtitle,
  image,
  imageSmall,
  ctaPrimaryText = '商品を見る',
  ctaPrimaryUrl = '/products',
  ctaSecondaryText,
  ctaSecondaryUrl
} = Astro.props;

// Use provided images or fallback to transparent placeholder
const bgLarge = image || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMSIgaGVpZ2h0PSIxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiNmNWY1ZjciLz48L3N2Zz4=';
const bgSmall = imageSmall || image || bgLarge;
---

<section
  class="hero fade-in bg-[#f5f5f7] h-[500px] md:h-[692px] bg-cover bg-center bg-no-repeat"
  style={`--bg-large: url(${bgLarge}); --bg-small: url(${bgSmall});`}
>
  <div class="pt-8 md:pt-24 text-center">
    <h2
      class="text-2xl font-extrabold tracking-tighter sm:text-5xl text-neutral-900"
    >
      {title}
    </h2>
    {subtitle && (
      <p class="mt-4 text-sm sm:text-xl font-semibold text-neutral-500">
        {subtitle}
      </p>
    )}
  </div>
  <div class="mt-4 flex justify-center gap-2">
    {ctaPrimaryText && ctaPrimaryUrl && (
      <a
        href={ctaPrimaryUrl}
        class="rounded-full bg-[#0a67d6] px-4 py-1.5 text-sm font-semibold text-white hover:bg-[#0956b8] transition-colors"
      >
        {ctaPrimaryText}
      </a>
    )}
    {ctaSecondaryText && ctaSecondaryUrl && (
      <a
        href={ctaSecondaryUrl}
        class="rounded-full border border-[#0a67d6] px-4 py-1.5 text-sm font-semibold text-[#0a67d6] hover:bg-[#0a67d6] hover:text-white transition-colors"
      >
        {ctaSecondaryText}
      </a>
    )}
  </div>
</section>

<style>
  /* 背景切り替え */
  .hero {
    background-image: var(--bg-large);
  }
  @media (max-width: 768px) {
    .hero {
      background-image: var(--bg-small);
    }
  }

  /* フェードイン初期状態 */
  .fade-in {
    opacity: 0;
    transform: translateY(24px);
    transition:
      opacity 0.8s ease,
      transform 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    will-change: opacity, transform;
  }

  /* 表示状態 */
  .fade-in.is-visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>

<script>
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("is-visible");
          observer.unobserve(entry.target);
        }
      });
    },
    {
      threshold: 0.2,
    }
  );

  document.querySelectorAll(".fade-in").forEach((el) => {
    observer.observe(el);
  });
</script>
