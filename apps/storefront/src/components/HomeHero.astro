
---
import { getImage } from "astro:assets";
import { HERO_IMAGES } from "../data/heroImages";

const { hero, title, subtitle } = Astro.props;

const images = HERO_IMAGES[hero];
if (!images) throw new Error(`Unknown hero key: ${hero}`);

const bgImage = await getImage({ src: images.large });
const bgSmallImage = await getImage({ src: images.small });
---

<section
  class="hero fade-in bg-[#f5f5f7] h-[500px] md:h-[692px] bg-cover bg-center bg-no-repeat"
  style={`--bg-large: url(${bgImage.src}); --bg-small: url(${bgSmallImage.src});`}
>
  <div class="pt-8 md:pt-24 text-center">
    <h2
      class="text-2xl font-extrabold tracking-tighter sm:text-5xl text-neutral-900"
    >
      {title}
    </h2>
    <p class="mt-4 text-sm sm:text-xl font-semibold text-neutral-500">
      {subtitle}
    </p>
  </div>
  <div class="mt-4 flex justify-center gap-2">
    <button
      class="rounded-full bg-[#0a67d6] px-4 py-1.5 text-sm font-semibold text-white"
    >
      商品を見る
    </button>
    <button
      class="rounded-full border border-[#0a67d6] px-4 py-1.5 text-sm font-semibold text-[#0a67d6]"
    >
      カートに追加
    </button>
  </div>
</section>

<style>
  /* 背景切り替え */
  .hero {
    background-image: var(--bg-large);
  }
  @media (max-width: 768px) {
    .hero {
      background-image: var(--bg-small);
    }
  }

  /* フェードイン初期状態 */
  .fade-in {
    opacity: 0;
    transform: translateY(24px);
    transition:
      opacity 0.8s ease,
      transform 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    will-change: opacity, transform;
  }

  /* 表示状態 */
  .fade-in.is-visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>

<script>
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("is-visible");
          observer.unobserve(entry.target);
        }
      });
    },
    {
      threshold: 0.2,
    }
  );

  document.querySelectorAll(".fade-in").forEach((el) => {
    observer.observe(el);
  });
</script>
