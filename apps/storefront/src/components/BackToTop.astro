---
import { t } from '../i18n';
---

<button
	id="back-to-top"
	type="button"
	class="fixed bottom-6 right-6 z-50 hidden w-11 h-11 items-center justify-center rounded-full bg-brand text-white shadow-lg hover:bg-brand-hover transition-all duration-300 opacity-0 translate-y-4"
	aria-label={t('accessibility.backToTop')}
>
	<svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
		<path d="m18 15-6-6-6 6" />
	</svg>
</button>

<script>
	const btn = document.getElementById('back-to-top');
	if (btn) {
		const toggleVisibility = () => {
			if (window.scrollY > 300) {
				btn.classList.remove('hidden');
				btn.classList.add('flex');
				requestAnimationFrame(() => {
					btn.classList.remove('opacity-0', 'translate-y-4');
					btn.classList.add('opacity-100', 'translate-y-0');
				});
			} else {
				btn.classList.add('opacity-0', 'translate-y-4');
				btn.classList.remove('opacity-100', 'translate-y-0');
				btn.addEventListener('transitionend', () => {
					if (window.scrollY <= 300) {
						btn.classList.add('hidden');
						btn.classList.remove('flex');
					}
				}, { once: true });
			}
		};

		let ticking = false;
		window.addEventListener('scroll', () => {
			if (!ticking) {
				requestAnimationFrame(() => {
					toggleVisibility();
					ticking = false;
				});
				ticking = true;
			}
		}, { passive: true });

		btn.addEventListener('click', () => {
			window.scrollTo({ top: 0, behavior: 'smooth' });
		});
	}
</script>
