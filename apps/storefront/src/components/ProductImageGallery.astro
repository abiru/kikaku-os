---
import { t } from '../i18n';

interface Props {
	images: Array<{ id: number; src: string; alt: string; primary: boolean }>;
}

const { images } = Astro.props;
---

<div class="mt-8 lg:col-span-7 lg:col-start-1 lg:row-span-3 lg:row-start-1 lg:mt-0">
	<h2 class="sr-only">{t('product.images')}</h2>

	<div class="grid grid-cols-1 lg:grid-cols-2 lg:grid-rows-3 lg:gap-8">
		{images.length > 0 ? (
			images.map((image, index) => (
				<img
					id={index === 0 ? 'main-image' : undefined}
					alt={image.alt}
					src={image.src}
					loading={image.primary ? 'eager' : 'lazy'}
					fetchpriority={image.primary ? 'high' : undefined}
					class:list={[
						'rounded-lg object-cover w-full',
						image.primary ? 'lg:col-span-2 lg:row-span-2 aspect-square' : 'hidden lg:block aspect-square',
					]}
				/>
			))
		) : (
			<div class="lg:col-span-2 lg:row-span-2 aspect-square rounded-lg bg-gray-100 flex items-center justify-center">
				<svg class="h-24 w-24 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
					<path stroke-linecap="round" stroke-linejoin="round" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
				</svg>
			</div>
		)}
	</div>

	{/* Thumbnail navigation for mobile */}
	{images.length > 1 && (
		<div class="mt-4 flex gap-4 overflow-x-auto lg:hidden">
			{images.map((image, index) => (
				<button
					type="button"
					data-index={index}
					data-url={image.src}
					class:list={[
						'thumbnail shrink-0 w-20 h-20 rounded-lg overflow-hidden ring-2 ring-offset-2 transition-all',
						index === 0 ? 'ring-[#0071e3]' : 'ring-transparent hover:ring-gray-300',
					]}
				>
					<img src={image.src} alt={image.alt} width="80" height="80" loading="lazy" class="w-full h-full object-cover" />
				</button>
			))}
		</div>
	)}
</div>
